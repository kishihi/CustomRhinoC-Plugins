#写了一个C#插件(ProjectFlowEx),以一个向量方向基于基准曲面将物体流动到目标曲面, 但寻求改进思路

# 插件名称: 以投影方向将物体流动到曲面

ProjectFlowEx 是一个为 Rhino 开发的插件命令（ProjectFlowEx），用于把选中的几何按用户指定的投影方向或基准面法向，在两个曲面（Base / Target）之间做映射/变形。它结合了“投影 + 映射 + 可选基于法向的旋转”能力，方便在复杂形体之间进行几何迁移与形变。

## 使用说明

选择需要投影的物体

选择基准面和目标曲面,可以是多重曲面, 

选择投影方向, 需要投影的物体在投影方向上需要完全被基准面和目标面涵盖

这对于一些想将花纹实体图案在其他面上做,但是又想要精确贴上其他曲面尤其有用, rhino内置的uv展开和曲面流动不太好用,也不支持多重曲面

## 算法实现

1. 单点变换:

若有点A, 以一个过点A的向量vectora作无限长的直线与基准曲面和目标曲线相交, 分别得到FrompT和topt.

计算frompt和topt在vectora的移动量, 将点a移动对应移动量得到点a2.

如果想要在目标曲面上以法向方向排列,则计算vector(frompt-topt)和目标曲面在topt的法向量的旋转角度angle1, 以topt为基点, vector(frompt-topt)为基向量,旋转angle1角度. 

其他想要的方向亦同理

2. 基于点变换来变换geometry:

对于曲线转换成nurbscurve, 通过变动控制点,来贴到目标曲面上

细分,网格,挤出物体,曲面统一转换成brep处理

对于brep的每个face转换成nurbssurface, 通过变动控制点,来贴到目标曲面上


## 限制与已知问题

对于Trimed曲面,投影到目标曲面上会恢复成untrimmed曲面, 或者需要转成网格面来处理

不会自动计算公差,如果想要尽量贴合目标曲面,需要插件控制点在曲线或者曲面上

我不知道有什么更好的办法来基于点变换来变换几何体,我知道cageedit, 但是没有开放接口在C# rhinocommon上

对于已修剪曲面也不知道怎么处理(也许可以同时把brep trimme曲线也变换到目标曲面上然后裁剪变换后的untrimmed曲面,以保留trimmed状态, 但不会写)

如何自动减掉投影的物体超过目标曲面的部分呢?




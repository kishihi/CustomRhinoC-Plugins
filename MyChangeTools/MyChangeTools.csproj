<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<!-- Select the framework(s) you wish to target.
        Rhino 6: net45
        Rhino 7: net48
        Rhino 8 Windows: net48, net7.0, net7.0-windows, net7.0-windows10.0.22000.0, etc
        Rhino 8 Mac: net7.0, net7.0-macos, net7.0-macos12.0, etc
    -->
		<TargetFrameworks>net7.0;net48</TargetFrameworks>
		<EnableDynamicLoading>true</EnableDynamicLoading>
		<TargetExt>.rhp</TargetExt>
		<NoWarn>NU1701</NoWarn>
		<LangVersion>7.0</LangVersion>
	</PropertyGroup>


	<PropertyGroup>
		<!-- Specifies information for Assembly and Yak -->
		

		<Version>1.3</Version>
		<AssemblyVersion>$(Version)</AssemblyVersion>
		<Title>MyChangeTools</Title>
		<Company>MyChangeTools Authors</Company>
		<Description>Description of MyChangeTools</Description>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Configuration)|$(TargetFramework)|$(Platform)'=='Debug|net7.0|AnyCPU'">
		<TreatWarningsAsErrors>True</TreatWarningsAsErrors>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Configuration)|$(TargetFramework)|$(Platform)'=='Debug|net48|AnyCPU'">
		<TreatWarningsAsErrors>True</TreatWarningsAsErrors>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Configuration)|$(TargetFramework)|$(Platform)'=='Release|net7.0|AnyCPU'">
		<TreatWarningsAsErrors>True</TreatWarningsAsErrors>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Configuration)|$(TargetFramework)|$(Platform)'=='Release|net48|AnyCPU'">
		<TreatWarningsAsErrors>True</TreatWarningsAsErrors>
	</PropertyGroup>

	<ItemGroup>

		<!-- <PackageReference Include="RhinoCommon" Version="8.24.25281.15001" />  -->


		<Reference Include="RhinoCommon">
			<HintPath>C:\Program Files\Rhino 7\System\RhinoCommon.dll</HintPath>
			<Private>false</Private>
		</Reference>

	</ItemGroup>


	<PropertyGroup>
		<CopyLocalLockFileAssemblies>false</CopyLocalLockFileAssemblies>
	</PropertyGroup>


	<Target Name="PostBuild" AfterTargets="PostBuildEvent">
		<Exec Command="&#xD;&#xA;    @echo off&#xD;&#xA;    setlocal ENABLEDELAYEDEXPANSION&#xD;&#xA;&#xD;&#xA;    REM === 获取插件文件名 ===&#xD;&#xA;    for %%f in (&quot;$(TargetPath)&quot;) do set PLUGINNAME=%%~nf&#xD;&#xA;&#xD;&#xA;    REM === 使用 PowerShell 获取当前日期时间 (yyMMdd.HHmm) ===&#xD;&#xA;    for /f %%a in ('powershell -NoProfile -Command &quot;Get-Date -Format yyMMdd.HHmm&quot;') do set DATETIME=%%a&#xD;&#xA;&#xD;&#xA;    REM === 获取版本号（优先 AssemblyInfo.cs，否则用 Version 属性） ===&#xD;&#xA;    set VERSION=$(Version)&#xD;&#xA;    if exist &quot;$(ProjectDir)Properties\AssemblyInfo.cs&quot; (&#xD;&#xA;      for /f &quot;tokens=2 delims==&quot; %%b in ('findstr AssemblyVersion &quot;$(ProjectDir)Properties\AssemblyInfo.cs&quot;') do set VERSION=%%b&#xD;&#xA;      set VERSION=!VERSION:&quot;=!&#xD;&#xA;    )&#xD;&#xA;&#xD;&#xA;    REM === 拼接完整版本号字符串 ===&#xD;&#xA;    set FULLVER=v!VERSION!.!DATETIME!&#xD;&#xA;&#xD;&#xA;    REM === 定义本地输出目录，区分框架 ===&#xD;&#xA;    set TARGET=$(ProjectDir)bin\Release\!FULLVER!\$(TargetFramework)&#xD;&#xA;&#xD;&#xA;    REM === 创建输出目录 ===&#xD;&#xA;    if not exist &quot;!TARGET!&quot; mkdir &quot;!TARGET!&quot;&#xD;&#xA;&#xD;&#xA;    REM === 复制 rhp 到本地版本输出目录 ===&#xD;&#xA;    xcopy &quot;$(TargetPath)&quot; &quot;!TARGET!\&quot; /Y &gt;nul&#xD;&#xA;	&#xD;&#xA;	@echo copyed !TARGET!&#xD;&#xA;	&#xD;&#xA;    set USB_TARGET=E:\!PLUGINNAME!\!FULLVER!\$(TargetFramework)&#xD;&#xA;&#xD;&#xA;    REM === 如果U盘存在则复制一份到U盘，保持版本号+框架目录 ===&#xD;&#xA;    if exist &quot;E:\RhinoLearn\Csharp&quot; (&#xD;&#xA;      if not exist &quot;!USB_TARGET!&quot; mkdir &quot;!USB_TARGET!&quot;&#xD;&#xA;      xcopy &quot;$(TargetPath)&quot; &quot;!USB_TARGET!\&quot; /Y &gt;nul&#xD;&#xA;    )&#xD;&#xA;	@echo copyed !USB_TARGET!&#xD;&#xA;&#xD;&#xA;    @echo ✅ 已生成版本: !FULLVER! (框架: $(TargetFramework))&#xD;&#xA;    endlocal&#xD;&#xA;  " />
	</Target>







</Project>
